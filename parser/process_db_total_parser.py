from db_total_parser import SampleRetriever

# -----------------------------------------------------------------------------
#
# -----------------------------------------------------------------------------
def write_parsed(f, category, data):
	for line in data:
		row = list(line)
		row[0] = ":".join(category[row[0]])
		row[2] = str(row[2])
		f.write('"'+'","'.join([v for v in row])+'"\n')

# -----------------------------------------------------------------------------
#
# -----------------------------------------------------------------------------
f_data = open('data.csv', "w")

# -----------------------------------------------------------------------------
#
# -----------------------------------------------------------------------------
SR = SampleRetriever('2014-12-06')

# -----------------------------------------------------------------------------
#
# -----------------------------------------------------------------------------
print '\n!!!!! SUSAN'
SR.sampleSusan()
write_parsed(f_data, SR.susanCategory, SR.susanData)

# -----------------------------------------------------------------------------
#
# -----------------------------------------------------------------------------
print '\n!!!!! KAMIS'
SR.sampleKamis()
write_parsed(f_data, SR.kamisCategory, SR.kamisData)

# -----------------------------------------------------------------------------
#
# -----------------------------------------------------------------------------
print '\n!!!!! EKAPEPIA'
SR.sampleEkapepia()
write_parsed(f_data, SR.ekapepiaCategory, SR.ekapepiaData)

# -----------------------------------------------------------------------------
#
# -----------------------------------------------------------------------------
f_data.close()